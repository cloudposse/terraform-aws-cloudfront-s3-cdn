# Atmos Configuration â€” powered by https://atmos.tools
#
# This configuration enables centralized, DRY, and consistent project scaffolding using Atmos.
#
# Included features:
# - Organizational custom commands: https://atmos.tools/core-concepts/custom-commands
# - Automated README generation: https://atmos.tools/cli/commands/docs/generate
#

# Import shared configuration used by all modules
import:
  - https://raw.githubusercontent.com/cloudposse/.github/refs/heads/main/.github/atmos/terraform-module.yaml

commands:
- name: readme
  steps:
    - "atmos docs generate readme"
    - "atmos docs generate readme --chdir modules/lambda@edge"

- name: test
  commands:
  - name: "init"
    description: Initialize tests
    steps:
      - "make -C test/src init"

  - name: "run"
    description: Run tests
    steps:
      - "cd test/src && go mod tidy"
      - "cd test/src && go test -v -timeout 60m"

  - name: "clean"
    description: Clean tests
    steps:
      - "make -C test/src clean"
      - "rm -rf examples/*/.terraform examples/*/.terraform.lock.hcl"
